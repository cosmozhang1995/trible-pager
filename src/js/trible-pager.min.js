function TriblePager(a,b,c){var d=this;this.container=null,this.view=null,this.pageContainer=null,this.closeButton=null;var e=null,f=!1,g={x:0,y:0,time:0,touchMoved:!1};this.pageSize={width:0,height:0,marginLeft:0,marginTop:0},this.config={animateDuration:200,animateEasing:"swing",imgSrcKey:"url",defaultImgSrc:null,clickListener:null,clickDelay:300,longTouchListener:null,longTouchDelay:2e3,sensitivity:.5,pageSize:{width:"90%",height:"90%"},imageAdjustment:"proportion",loadingIndicator:null,closeButton:null,destroyCallback:null,createCallback:null,immediately:!0,elementId:null,pagingRegion:"0%"},this.list=a&&a.join?a:[],this.currentIndex=b?b:0,$.extend(this.config,c);var h=function(a){a&&a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0};this.initPageSize=function(){if(this.container){var a=$(window).width(),b=$(window).height();if($(this.container).css("width",a+"px"),$(this.container).css("height",b+"px"),this.pageSize.width=.9*a,this.pageSize.height=.9*b,this.config.pageSize.width.indexOf("%")>0){var c=parseFloat(this.config.pageSize.width.replace(/[^\d]/g,""));this.pageSize.width=a*(c/100)}else if(this.config.pageSize.width.indexOf("px")){var e=parseFloat(this.config.pageSize.width.replace(/[^\d]/g,""));this.pageSize.width=e}else"number"==typeof this.config.pageSize.width&&(this.pageSize.width=parseFloat(this.config.pageSize.width));if(this.config.pageSize.height.indexOf("%")>0){var c=parseFloat(this.config.pageSize.height.replace(/[^\d]/g,""));this.pageSize.height=b*(c/100)}else if(this.config.pageSize.height.indexOf("px")){var e=parseFloat(this.config.pageSize.height.replace(/[^\d]/g,""));this.pageSize.height=e}else"number"==typeof this.config.pageSize.height&&(this.pageSize.height=parseFloat(this.config.pageSize.height));this.pageSize.marginLeft=.5*(parseFloat(a)-parseFloat(this.pageSize.width)),this.pageSize.marginTop=.5*(parseFloat(b)-parseFloat(this.pageSize.height)),$(this.view).css("margin-left",this.pageSize.marginLeft+"px"),$(this.view).css("margin-right",this.pageSize.marginLeft+"px"),$(this.view).css("margin-top",this.pageSize.marginTop+"px"),$(this.view).css("margin-bottom",this.pageSize.marginTop+"px"),$(this.container).find(".pager-page").css("width",this.pageSize.width+"px"),$(this.container).find(".pager-page").css("height",this.pageSize.height+"px"),$(this.container).find(".pager-page .loading-indicator").css("line-height",this.pageSize.height+"px"),$(this.view).css("width",this.pageSize.width+"px"),$(this.view).css("height",this.pageSize.height+"px"),$(this.pageContainer).css("margin-left",0-this.pageSize.width+"px"),$(this.pageContainer).find(".pager-page .pager-loading-indicator").each(function(){this.style.lineHeight=d.pageSize.height+"px"}),$(this.pageContainer).find(".pager-page img").each(function(){"function"==typeof this.pagerResize&&this.pagerResize()})}};var i=function(a){a.clientX&&a.clientY||(a.clientX=a.changedTouches[0].clientX,a.clientY=a.changedTouches[0].clientY),a.preventDefault(),f=!0,g.time=(new Date).getTime(),g.touchMoved=!1,setTimeout(function(){g.touchMoved||"function"!=typeof d.config.longTouchListener||d.config.longTouchListener(a,d)},d.config.longTouchDelay),g.x=a.clientX+(document.body.scrollLeft||document.documentElement.scrollLeft),g.y=a.clientY+(document.body.scrollTop||document.documentElement.scrollTop),h(a)},j=function(a){if(a.clientX&&a.clientY||(a.clientX=a.changedTouches[0].clientX,a.clientY=a.changedTouches[0].clientY),a.preventDefault(),f){g.touchMoved=!0;var b=a.clientX+(document.body.scrollLeft||document.documentElement.scrollLeft),c=a.clientY+(document.body.scrollTop||document.documentElement.scrollTop),e=b-g.x;c-g.y,$(d.pageContainer).css("marginLeft",e-d.pageSize.width+"px")}h(a)},k=function(a){if(a.clientX&&a.clientY||(a.clientX=a.changedTouches[0].clientX,a.clientY=a.changedTouches[0].clientY),a.preventDefault(),f){var b=(new Date).getTime();b-g.time<d.config.clickDelay&&(g.touchMoved||"function"!=typeof d.config.clickListener||d.config.clickListener(a,d));var c=a.clientX+(document.body.scrollLeft||document.documentElement.scrollLeft),e=a.clientY+(document.body.scrollTop||document.documentElement.scrollTop),i=c-g.x;e-g.y,i>0?i>parseFloat(d.pageSize.width)*d.config.sensitivity?d.gotoPrev():d.gotoCurrent():0-i>parseFloat(d.pageSize.width)*d.config.sensitivity?d.gotoNext():d.gotoCurrent()}f=!1,h(a)},l=!1;this.gotoNext=function(){if(!l){var a=this;a.currentIndex+1<a.list.length?(l=!0,$(a.pageContainer).animate({marginLeft:0-2*a.pageSize.width+"px"},a.config.animateDuration,a.config.animateEasing,function(){a.currentIndex+=1;var b=a.currentIndex+1<a.list.length?a.list[a.currentIndex+1][a.config.imgSrcKey]:null;a.pushPage(b),a.shiftPage(),a.pageContainer.style.marginLeft=0-a.pageSize.width+"px",l=!1})):(l=!0,$(a.pageContainer).animate({marginLeft:0-a.pageSize.width+"px"},a.config.animateDuration,a.config.animateEasing,function(){l=!1}))}},this.gotoPrev=function(){if(!l){var a=this;a.currentIndex-1>=0?(l=!0,$(a.pageContainer).animate({marginLeft:"0px"},a.config.animateDuration,a.config.animateEasing,function(){a.currentIndex-=1;var b=a.currentIndex-1>=0?a.list[a.currentIndex-1][a.config.imgSrcKey]:null;a.insertPage(b),a.popPage(),a.pageContainer.style.marginLeft=0-a.pageSize.width+"px",l=!1})):(l=!0,$(a.pageContainer).animate({marginLeft:0-a.pageSize.width+"px"},a.config.animateDuration,a.config.animateEasing,function(){l=!1}))}},this.gotoCurrent=function(){if(!l){var a=this;l=!0,$(a.pageContainer).animate({marginLeft:0-a.pageSize.width+"px"},a.config.animateDuration,a.config.animateEasing,function(){l=!1})}},this.createPager=function(){this.container=document.createElement("div"),this.container.className="pager-container",this.view=document.createElement("div"),this.view.className="pager",this.pageContainer=document.createElement("div"),this.pageContainer.className="pager-page-container",this.config.elementId&&(this.container.id=this.config.elementId),this.config.closeButton&&(this.closeButton=document.createElement("div"),this.closeButton.className="pager-close-button",this.closeButton.innerHTML=this.config.closeButton,this.closeButton.onclick=function(){d.destroy()});var a=document.createElement("div");a.className="pager-nav-region-prev";var b=document.createElement("div");b.className="pager-nav-region-next";var c=d.config.pagingRegion;"number"==typeof c?c+="px":c="string"==typeof c?c.indexOf("px")>0?parseFloat(c.replace(/px/g,""))+"px":c.indexOf("%")>0?parseFloat(c.replace(/%/g,""))+"%":"0px":"0px",a.style.width=c,b.style.width=c,a.onclick=function(a){a.preventDefault(),h(a),d.gotoPrev()},b.onclick=function(a){a.preventDefault(),h(a),d.gotoNext()},this.container.appendChild(this.view),this.config.closeButton&&this.container.appendChild(this.closeButton),this.view.appendChild(this.pageContainer),this.view.appendChild(a),this.view.appendChild(b),document.body.appendChild(this.container),this.view.ontouchstart=i,this.view.ontouchmove=j,this.view.ontouchend=k,this.view.onmousedown=i,this.view.onmousemove=j,this.view.onmouseup=k;var e=this.currentIndex-1>=0?this.list[this.currentIndex-1][this.config.imgSrcKey]:null,f=this.currentIndex>=0&&this.currentIndex<this.list.length?this.list[this.currentIndex][this.config.imgSrcKey]:null,g=this.currentIndex+1<this.list.length?this.list[this.currentIndex+1][this.config.imgSrcKey]:null;this.initializePager(e,f,g),this.initPageSize()},this.initializePager=function(a,b,c){for(var d=this.pageContainer.childNodes,e=d.length-1;e>=0;e--)this.pageContainer.removeChild(d[e]);this.pushPage(a),this.pushPage(b),this.pushPage(c)};var m=function(){$(this).css("height","auto"),$(this).css("width","auto");var a=$(this).parents(".pager-page")[0],b=parseFloat($(a).width()),c=parseFloat($(a).height()),e=parseFloat($(this).width()),f=parseFloat($(this).height());if(e>0&&f>0)if("fill"===d.config.imageAdjustment)$(this).css("width",b+"px"),$(this).css("height",c+"px"),$(this).css("marginLeft","0px"),$(this).css("marginTop","0px"),$(this).css("marginRight","0px"),$(this).css("marginBottom","0px");else{for(var g=d.config.imageAdjustment.split("|"),h=!1,i=!1,j=!1,k=0;k<g.length;k++)"proportion"===g[k]?h=!0:"cut"===g[k]?i=!0:"auto"===g[k]&&(j=!0);if(h||i||j||(h=!0),h)if(e/f>b/c)if(e>b||!j){var l=e/b,m=e/l,n=f/l;$(this).css("width",m+"px"),$(this).css("height",n+"px"),$(this).css("marginLeft",(b-m)/2+"px"),$(this).css("marginTop",(c-n)/2+"px"),$(this).css("marginRight",(b-m)/2+"px"),$(this).css("marginBottom",(c-n)/2+"px")}else{var m=e,n=f;$(this).css("width",m+"px"),$(this).css("height",n+"px"),$(this).css("marginLeft",(b-m)/2+"px"),$(this).css("marginTop",(c-n)/2+"px"),$(this).css("marginRight",(b-m)/2+"px"),$(this).css("marginBottom",(c-n)/2+"px")}else if(f>c||!j){var l=f/c,m=e/l,n=f/l;$(this).css("width",m+"px"),$(this).css("height",n+"px"),$(this).css("marginLeft",(b-m)/2+"px"),$(this).css("marginTop",(c-n)/2+"px"),$(this).css("marginRight",(b-m)/2+"px"),$(this).css("marginBottom",(c-n)/2+"px")}else{var m=e,n=f;$(this).css("width",m+"px"),$(this).css("height",n+"px"),$(this).css("marginLeft",(b-m)/2+"px"),$(this).css("marginTop",(c-n)/2+"px"),$(this).css("marginRight",(b-m)/2+"px"),$(this).css("marginBottom",(c-n)/2+"px")}else if(i)if(e/f>b/c)if(f>c||!j){var l=f/c,m=e/l,n=f/l;$(this).css("width",m+"px"),$(this).css("height",n+"px"),$(this).css("marginLeft",(b-m)/2+"px"),$(this).css("marginTop",(c-n)/2+"px"),$(this).css("marginRight",(b-m)/2+"px"),$(this).css("marginBottom",(c-n)/2+"px")}else{var m=e,n=f;$(this).css("width",m+"px"),$(this).css("height",n+"px"),$(this).css("marginLeft",(b-m)/2+"px"),$(this).css("marginTop",(c-n)/2+"px"),$(this).css("marginRight",(b-m)/2+"px"),$(this).css("marginBottom",(c-n)/2+"px")}else if(e>b||!j){var l=e/b,m=e/l,n=f/l;$(this).css("width",m+"px"),$(this).css("height",n+"px"),$(this).css("marginLeft",(b-m)/2+"px"),$(this).css("marginTop",(c-n)/2+"px"),$(this).css("marginRight",(b-m)/2+"px"),$(this).css("marginBottom",(c-n)/2+"px")}else{var m=e,n=f;$(this).css("width",m+"px"),$(this).css("height",n+"px"),$(this).css("marginLeft",(b-m)/2+"px"),$(this).css("marginTop",(c-n)/2+"px"),$(this).css("marginRight",(b-m)/2+"px"),$(this).css("marginBottom",(c-n)/2+"px")}else if(j){var m=e,n=f;$(this).css("width",m+"px"),$(this).css("height",n+"px"),$(this).css("marginLeft",(b-m)/2+"px"),$(this).css("marginTop",(c-n)/2+"px"),$(this).css("marginRight",(b-m)/2+"px"),$(this).css("marginBottom",(c-n)/2+"px")}}},n=function(a){var b=document.createElement("div");b.className="pager-page";var c=document.createElement("div");c.className="pager-loading-indicator";var e=document.createElement("div");e.className="pager-loading-indicator-content";var f=document.createElement("img");return b.style.width=d.pageSize.width+"px",b.style.height=d.pageSize.height+"px",c.style.lineHeight=d.pageSize.height+"px",f.style.width="auto",f.style.height="auto",d.config.loadingIndicator&&a&&(e.innerHTML=d.config.loadingIndicator),a&&b.appendChild(f),c.appendChild(e),b.appendChild(c),a&&(f.pagerResize=m,f.onerror=function(){d.config.defaultImgSrc?this.src=d.config.defaultImgSrc:(this.removeAttribute("src"),$(this).hide())},f.onload=function(){"function"==typeof this.pagerResize&&this.pagerResize(),$(c).hide()},f.src=a),b};this.pushPage=function(a){var b=n(a);this.pageContainer.appendChild(b)},this.insertPage=function(a){var b=n(a);this.pageContainer.insertBefore(b,this.pageContainer.childNodes[0])},this.shiftPage=function(){$($(this.pageContainer).find(".pager-page")[0]).remove()},this.popPage=function(){var a=$(this.pageContainer).find(".pager-page");a.length>0&&$(a[a.length-1]).remove()},this.destroy=function(){$(this.container).remove(),window.clearInterval(e),"function"==typeof this.config.destroyCallback&&this.config.destroyCallback(this)},this.create=function(){this.createPager(),$(window).resize(function(){d.initPageSize()}),e=window.setInterval(function(){$(d.pageContainer).find(".pager-page img").each(function(){var a=$(this).width(),b=$(this).height(),c=$(this).data("pagerLastWidth"),d=$(this).data("pagerLastHeight");(a!==c||b!==d)&&($(this).data("pagerLastWidth",a),$(this).data("pagerLastHeight",b),"function"==typeof this.pagerResize&&this.pagerResize())})},200),"function"==typeof this.config.createCallback&&this.config.createCallback(this)},this.config.immediately&&this.create()}